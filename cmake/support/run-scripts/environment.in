#!/bin/sh

PREFIX=`readlink "$0"`
# Iterate down a (possible) chain of symlinks (macOS does not have readlink -f)
while [ -L "$PREFIX" ]
do
   PREFIX=`readlink "$PREFIX"`
done

PREFIX=`dirname $PREFIX`
PREFIX=`dirname $PREFIX`
PREFIX=`dirname $PREFIX`
echo $PREFIX
export @FLAVOR_UPPER@=$PREFIX/@FLAVOR@/@MCCODE_VERSION@
export @FLAVOR_UPPER@_TOOLS=$PREFIX/@FLAVOR@/@MCCODE_VERSION@/tools/Perl/
export PATH=$PREFIX/miniconda3/bin:$PREFIX/@FLAVOR@/@MCCODE_VERSION@/bin:/opt/mccode/openmpi/bin:/opt/mccode/gcc/bin:$PATH
echo
echo The new shell started here is now set up for running this version of @FLAVOR@:
echo
@FLAVOR@ -v
echo
echo To end using this version of mcstas, exit this shell.
echo
export PS1='@FLAVOR@-@MCCODE_VERSION@ env \w\$ > '
if [ -x "\${SHELL}" ]; then
  \${SHELL}
else
  /bin/sh
fi

