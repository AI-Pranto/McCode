<!DOCTYPE html>
<html>
<head>
	<meta charset=utf-8>
	<style>
		body { margin: 0; }
		canvas { width: 100%; height: 100% }
	</style>
</head>
<body>
	<script src="https://sim.e-neutrons.org/static/threejs/three.min.js"></script>
	<script src="https://sim.e-neutrons.org/static/threejs/dat.gui.min.js"></script>
	<script src="https://sim.e-neutrons.org/static/threejs/OrbitControls.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
	<script src="_mcdisplay.js"></script>
	<script src="_instr.js"></script>
	<script src="_neutrons.js"></script>

	<script>
		var x = -26.3, y = 26.3, z = 26.3;
		// INSERT_CAMPOS_HERE: x = XVAL, y = YVAL, z = ZVAL;
		var controller = new Controller(x, y, z);
		var viewmodel = controller.viewmodel;

		// UI event handlers interacting only(!!) with the viewmodel.
		// TODO: implement callbacks
		var handlePlayPause = function()
		{
			if (viewmodel.playBack == PlayBack.RUN)
			{
				viewmodel.setPlayBack(PlayBack.PAUSE);
			}
			else
			{
				viewmodel.setPlayBack(PlayBack.RUN);
			}
		}
		var handleNext = function()
		{
			viewmodel.playBack = PlayBack.PAUSE;
			viewmodel.setRayIdx(viewmodel.getRayIdx() + 1);
		}
		var handlePrev = function()
		{
			viewmodel.playBack = PlayBack.PAUSE;
			viewmodel.setRayIdx(viewmodel.getRayIdx() - 1);
		}
	</script>

	<div id="gui" style="width: auto; background-color: black;">
		<button id="btnPrev", onclick="handlePrev();">Previous</button>
		<button id="btnPlayPause", onclick="handlePlayPause();">Play/Pause</button>
		<button id="btnNext", onclick="handleNext();">Next</button>
	</div>
	<div id="3dcanvas"></div>

	<script>
		var updateGui = function()
		{
			var pb = viewmodel.getPlayBack();
			if (pb == PlayBack.RUN)
			{
				btn = document.getElementById("btnPlayPause");
				btn.innerHTML = "Pause";
			}
			if (pb == PlayBack.PAUSE)
			{

				btn = document.getElementById("btnPlayPause");
				btn.innerHTML = "Play";
			}
		}
		controller.setUpdateGuiFunc(updateGui);
		controller.run();
    </script>
</body>
</html>
