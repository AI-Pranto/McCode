#!/bin/sh

LIB="@TOOLS_LIB@"
TOOL="mcplot"
VERS="@MCCODE_VERSION@"

canrun_m() {
    if ! [ -x ${LIB}/${TOOL}.m ]; then
        exit 127;
    fi
    
    # is matlab on the path?
    if ! [ `which matlab` ]; 
            exit 127;
    fi
}

canrun_i() {
    if ! [ -x ${LIB}/${TOOL}.m ]; then
        exit 127;
    fi
    
    # is ifit on the path?
    if ! [ `which ifit` ]; then
            exit 127;
    fi
}


if ( canrun_m ); then
    matlab -nosplash -nodesktop -r "addpath('${LIB}');${TOOL} $*"
elif ( canrun_i ); then
    ifit -r $*
else
    echo ":: Failed to run Python ${TOOL}, trying old Perl version."
    echo ":: If this fails too, consider reinstalling ${TOOL}."
    echo ""

    # Try old Perl-version of mcplot if Python version cannot run
    ${TOOL} $*
fi
